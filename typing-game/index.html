<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Famous Text - 打字练习游戏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            width: 100%;
            max-width: 900px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            padding: 30px;
        }

        header {
            text-align: center;
            margin-bottom: 25px;
        }

        h1 {
            color: #2c3e50;
            font-size: 2.8rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.2rem;
        }

        .text-display {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 25px;
            height: 200px;
            overflow: hidden;
            position: relative;
            margin-bottom: 25px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
            font-size: 1.4rem;
            line-height: 1.6;
        }

        .text-content {
            white-space: pre-wrap;
            word-break: break-word;
        }

        .correct {
            color: #27ae60;
            background-color: rgba(39, 174, 96, 0.1);
        }

        .current {
            color: #f39c12;
            background-color: rgba(243, 156, 18, 0.2);
            border-radius: 3px;
            padding: 0 2px;
            text-decoration: underline;
        }

        .incorrect {
            color: #e74c3c;
            background-color: rgba(231, 76, 60, 0.2);
            border-radius: 3px;
            padding: 0 2px;
        }

        .stats-container {
            display: flex;
            justify-content: space-around;
            background: #3498db;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-box {
            text-align: center;
            color: white;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .keyboard-container {
            background: #2c3e50;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }

        .keyboard-row:last-child {
            margin-bottom: 0;
        }

        .key {
            background: #34495e;
            color: #ecf0f1;
            border: 2px solid #7f8c8d;
            border-radius: 8px;
            padding: 12px 15px;
            margin: 0 5px;
            min-width: 40px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: default;
            user-select: none;
            transition: all 0.1s ease;
            box-shadow: 0 3px 0 #2c3e50;
        }

        .key.space {
            min-width: 300px;
        }

        .key.active {
            background: #f39c12;
            transform: translateY(3px);
            box-shadow: 0 0 0 #2c3e50;
        }

        .key.special {
            background: #9b59b6;
        }

        .controls {
            display: flex;
            justify-content: center;
            margin-top: 25px;
        }

        button {
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 0 #2980b9;
        }

        button:hover {
            background: #2980b9;
            transform: translateY(2px);
            box-shadow: 0 2px 0 #2980b9;
        }

        button:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #2980b9;
        }

        .result-container {
            text-align: center;
            padding: 20px;
            background: #2ecc71;
            border-radius: 12px;
            margin-top: 20px;
            color: white;
            display: none;
        }

        .result-title {
            font-size: 1.8rem;
            margin-bottom: 15px;
        }

        .result-stats {
            font-size: 1.4rem;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .game-container {
                padding: 15px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .text-display {
                font-size: 1.1rem;
                padding: 15px;
                height: 180px;
            }
            
            .key {
                padding: 8px 10px;
                min-width: 30px;
                font-size: 0.9rem;
            }
            
            .key.space {
                min-width: 200px;
            }
            
            .stat-value {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <header>
            <h1>Famous Text</h1>
            <p class="subtitle">测试你的打字速度和准确性</p>
        </header>

        <div class="text-display">
            <div class="text-content" id="text-content"></div>
        </div>

        <div class="stats-container">
            <div class="stat-box">
                <div class="stat-value" id="wpm">0</div>
                <div class="stat-label">WPM</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="time">0</div>
                <div class="stat-label">秒</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="accuracy">100%</div>
                <div class="stat-label">准确率</div>
            </div>
        </div>

        <div class="keyboard-container">
            <div class="keyboard-row">
                <div class="key" data-key="q">Q</div>
                <div class="key" data-key="w">W</div>
                <div class="key" data-key="e">E</div>
                <div class="key" data-key="r">R</div>
                <div class="key" data-key="t">T</div>
                <div class="key" data-key="y">Y</div>
                <div class="key" data-key="u">U</div>
                <div class="key" data-key="i">I</div>
                <div class="key" data-key="o">O</div>
                <div class="key" data-key="p">P</div>
            </div>
            <div class="keyboard-row">
                <div class="key" data-key="a">A</div>
                <div class="key" data-key="s">S</div>
                <div class="key" data-key="d">D</div>
                <div class="key" data-key="f">F</div>
                <div class="key" data-key="g">G</div>
                <div class="key" data-key="h">H</div>
                <div class="key" data-key="j">J</div>
                <div class="key" data-key="k">K</div>
                <div class="key" data-key="l">L</div>
            </div>
            <div class="keyboard-row">
                <div class="key" data-key="z">Z</div>
                <div class="key" data-key="x">X</div>
                <div class="key" data-key="c">C</div>
                <div class="key" data-key="v">V</div>
                <div class="key" data-key="b">B</div>
                <div class="key" data-key="n">N</div>
                <div class="key" data-key="m">M</div>
            </div>
            <div class="keyboard-row">
                <div class="key space" data-key=" ">空格</div>
            </div>
        </div>

        <div class="controls">
            <button id="reset-btn">重新开始</button>
        </div>

        <div class="result-container" id="result-container">
            <div class="result-title">游戏完成!</div>
            <div class="result-stats">
                最终速度: <span id="final-wpm">0</span> WPM<br>
                用时: <span id="final-time">0</span> 秒<br>
                准确率: <span id="final-accuracy">100%</span>
            </div>
            <button id="play-again-btn">再玩一次</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 游戏文本
            const gameTexts = [
                "The quick brown fox jumps over the lazy dog. This sentence contains all letters of the English alphabet.",
                "Programming is the process of creating a set of instructions that tell a computer how to perform a task.",
                "Typing speed is measured in words per minute. Accuracy is equally important for effective typing.",
                "Practice makes perfect. The more you type, the better and faster you become at typing.",
                "In a hole in the ground there lived a hobbit. Not a nasty, dirty, wet hole filled with the ends of worms."
            ];
            
            // DOM 元素
            const textContent = document.getElementById('text-content');
            const wpmDisplay = document.getElementById('wpm');
            const timeDisplay = document.getElementById('time');
            const accuracyDisplay = document.getElementById('accuracy');
            const resetBtn = document.getElementById('reset-btn');
            const resultContainer = document.getElementById('result-container');
            const finalWpm = document.getElementById('final-wpm');
            const finalTime = document.getElementById('final-time');
            const finalAccuracy = document.getElementById('final-accuracy');
            const playAgainBtn = document.getElementById('play-again-btn');
            const keys = document.querySelectorAll('.key');
            
            // 游戏状态
            let currentText = '';
            let userInput = '';
            let startTime = null;
            let timerInterval = null;
            let gameActive = false;
            let correctChars = 0;
            let totalChars = 0;
            
            // 初始化游戏
            function initGame() {
                // 随机选择一个文本
                currentText = gameTexts[Math.floor(Math.random() * gameTexts.length)];
                userInput = '';
                startTime = null;
                gameActive = false;
                correctChars = 0;
                totalChars = 0;
                
                // 清除计时器
                if (timerInterval) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                }
                
                // 重置显示
                textContent.innerHTML = '';
                wpmDisplay.textContent = '0';
                timeDisplay.textContent = '0';
                accuracyDisplay.textContent = '100%';
                resultContainer.style.display = 'none';
                
                // 显示文本
                renderText();
            }
            
            // 渲染文本
            function renderText() {
                textContent.innerHTML = '';
                
                for (let i = 0; i < currentText.length; i++) {
                    const charSpan = document.createElement('span');
                    charSpan.textContent = currentText[i];
                    
                    if (i < userInput.length) {
                        if (userInput[i] === currentText[i]) {
                            charSpan.className = 'correct';
                        } else {
                            charSpan.className = 'incorrect';
                        }
                    } else if (i === userInput.length) {
                        charSpan.className = 'current';
                    }
                    
                    textContent.appendChild(charSpan);
                }
            }
            
            // 更新统计信息
            function updateStats() {
                if (!startTime) return;
                
                const currentTime = new Date();
                const elapsedTime = (currentTime - startTime) / 1000; // 秒
                timeDisplay.textContent = Math.floor(elapsedTime);
                
                // 计算 WPM (每分钟单词数)
                // 假设一个单词为5个字符
                const wordsTyped = correctChars / 5;
                const minutes = elapsedTime / 60;
                const wpm = minutes > 0 ? Math.round(wordsTyped / minutes) : 0;
                wpmDisplay.textContent = wpm;
                
                // 计算准确率
                const accuracy = totalChars > 0 ? Math.round((correctChars / totalChars) * 100) : 100;
                accuracyDisplay.textContent = `${accuracy}%`;
            }
            
            // 开始计时器
            function startTimer() {
                if (!startTime) {
                    startTime = new Date();
                    timerInterval = setInterval(updateStats, 100);
                }
            }
            
            // 检查游戏是否完成
            function checkGameCompletion() {
                if (userInput.length === currentText.length) {
                    // 游戏完成
                    gameActive = false;
                    clearInterval(timerInterval);
                    
                    // 显示结果
                    const finalTimeValue = Math.floor((new Date() - startTime) / 1000);
                    const finalWpmValue = parseInt(wpmDisplay.textContent);
                    const finalAccuracyValue = accuracyDisplay.textContent;
                    
                    finalWpm.textContent = finalWpmValue;
                    finalTime.textContent = finalTimeValue;
                    finalAccuracy.textContent = finalAccuracyValue;
                    resultContainer.style.display = 'block';
                }
            }
            
            // 处理按键按下
            function handleKeyDown(e) {
                if (!gameActive && e.key !== ' ') {
                    gameActive = true;
                    startTimer();
                }
                
                // 忽略特殊键（除了退格）
                if (e.key === 'Backspace') {
                    e.preventDefault();
                    if (userInput.length > 0) {
                        userInput = userInput.slice(0, -1);
                        renderText();
                        updateStats();
                    }
                    return;
                }
                
                // 只处理可见字符
                if (e.key.length === 1 || e.key === ' ') {
                    e.preventDefault();
                    userInput += e.key;
                    totalChars++;
                    
                    // 检查字符是否正确
                    const currentIndex = userInput.length - 1;
                    if (currentIndex < currentText.length && userInput[currentIndex] === currentText[currentIndex]) {
                        correctChars++;
                    }
                    
                    renderText();
                    updateStats();
                    checkGameCompletion();
                }
            }
            
            // 虚拟键盘反馈
            function updateVirtualKeyboard(e) {
                const keyElement = document.querySelector(`.key[data-key="${e.key.toLowerCase()}"]`);
                if (keyElement) {
                    keyElement.classList.add('active');
                    setTimeout(() => {
                        keyElement.classList.remove('active');
                    }, 150);
                }
            }
            
            // 事件监听器
            document.addEventListener('keydown', (e) => {
                handleKeyDown(e);
                updateVirtualKeyboard(e);
            });
            
            resetBtn.addEventListener('click', initGame);
            playAgainBtn.addEventListener('click', initGame);
            
            // 初始化游戏
            initGame();
        });
    </script>
</body>
</html>